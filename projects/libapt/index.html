<!doctype html><html data-theme=dark lang=en><head><meta charset=UTF-8><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://lts-linux.eu/ name=base><title>LTS Linux • Libapt</title><link href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 105 55"><text y=".7em" font-size="82">🐧</text></svg>' rel=icon><link title="LTS Linux - Atom Feed" href=https://lts-linux.eu/atom.xml rel=alternate type=application/atom+xml><link href="https://lts-linux.eu/custom_subset.css?h=753f2b519893883e57d5" rel=stylesheet><link href="https://lts-linux.eu/main.css?h=2e02623b98889ce02fac" rel=stylesheet><meta content="light dark" name=color-scheme><meta content="Libapt is a pure Rust apt library." name=description><meta content="Libapt is a pure Rust apt library." property=og:description><meta content="index, nofollow" name=robots><meta content=Libapt property=og:title><meta content=article property=og:type><meta content=en_GB property=og:locale><link href=https://lts-linux.euprojects/libapt/ rel=canonical><meta content=https://lts-linux.euprojects/libapt/ property=og:url><meta content="LTS Linux" property=og:site_name><meta content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self' https://cdn.jsdelivr.net/;style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com;connect-src 'self';script-src 'self' 'self'" http-equiv=Content-Security-Policy><noscript><link href=https://lts-linux.eu/no_js.css rel=stylesheet></noscript><script src=https://lts-linux.eu/js/initializeTheme.min.js></script><script defer src=https://lts-linux.eu/js/themeSwitcher.min.js></script><meta content=@ltslinux@social.tchncs.de name=fediverse:creator><script src="https://lts-linux.eu/js/searchElasticlunr.min.js?h=3626c0ef99daa745b31e" defer></script><body><header><nav class=navbar><div class=nav-title><a class=home-title href=https://lts-linux.eu>LTS Linux</a></div><div class=nav-navs><ul><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/blog/> Blog </a><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/archive/> Archiv </a><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/tags/> Tags </a><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/projects/> Topics </a><li class=js><div aria-label="Click or press $SHORTCUT to open search" class="search-icon interactive-icon" title="Click or press $SHORTCUT to open search" id=search-button role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><li class="theme-switcher-wrapper js"><div aria-label="Toggle dark mode" title="Toggle dark/light mode" aria-pressed=false class=theme-switcher role=button tabindex=0></div><div aria-label="Reset mode to default" class="theme-resetter arrow" title="Reset mode to default" aria-hidden=true role=button tabindex=0></div></ul></div></nav></header><div class=content><main><article><h1 class=article-title>Libapt</h1><ul class=meta><li>By Tom Irgang</li> • <li>30 October 2024</li> • <li>Tags: <li><a href=https://lts-linux.eu/tags/rust/>Rust</a>, <li><a href=https://lts-linux.eu/tags/library/>library</a>, <li><a href=https://lts-linux.eu/tags/apt/>APT</a>, <li><a href=https://lts-linux.eu/tags/debian/>Debian</a></ul><ul class="meta last-updated"><li>Updated on 2 November 2024</li> • <li><a href=https://github.com/lts-linux/lts-linux.github.io/commits/main/content/projects/libapt/index.md>See changes<small> <span class=arrow-corner>↗</span></small></a></ul><section class=body><img src=/projects/libapt/Libapt.webp width=50%><p>Libapt is a pure Rust apt library.<p>You can find the sources at <a href=https://codeberg.org/tomirgang/libapt>Codeberg</a> and <a href=https://github.com/lts-linux/libapt>Github</a>.<h2 id=architecture><a aria-label="Anchor link for: architecture" class="header-anchor no-hover-padding" href=#architecture><span aria-hidden=true class=link-icon></span></a> Architecture</h2><p>This crate provides a pure Rust interface for Debian repositories.<h3 id=debian-apt-repositories><a aria-label="Anchor link for: debian-apt-repositories" class="header-anchor no-hover-padding" href=#debian-apt-repositories><span aria-hidden=true class=link-icon></span></a> Debian apt repositories</h3><p>The format of Debian, i.e. apt, repositories is described in the <a href=https://wiki.debian.org/DebianRepository/Format#Debian_Repository_Format>Debian wiki</a>.<p>In general, apt repositories consist of distributions and packages. The path to this file on the server depends on the repository type. By default, a apt repository is structured in the following way:<pre class="language-plain z-code" data-lang=plain><code class=language-plain data-lang=plain><span class="z-text z-plain">Root --- /dists ------ /dist_a
</span><span class="z-text z-plain">      \          \---- /dist_b
</span><span class="z-text z-plain">       \          \--- ...
</span><span class="z-text z-plain">        \
</span><span class="z-text z-plain">         \--/pool ----- /a
</span><span class="z-text z-plain">                   \--- /b                  
</span><span class="z-text z-plain">                    \-- ...
</span></code></pre><p>The dists folder contains one or many distributions.<p>Each distribution is defined by a <em>InRelease</em>, or <em>Release</em>, index file. This index file is signed using GPG key of the distribution provider. The matching public key is typically installed on the local machine, and the client tool verifies the signature to ensure the repository was not manipulated.<p>The distribution index file contains relative paths and checksums to package index files. These package indices are grouped by <em>components</em>. The client tool downloads the wanted component indices, verifies the integrity using the checksum, and parses the packages <em><a href=https://wiki.debian.org/DebianRepository/Format#A.22Packages.22_Indices>stanzas</a></em>.<p>The package indices provide, as part of the stanzas, paths to the packages, relative to the root of the apt repository, and checksums for each package. These checksums allow verification of the packages after download.<p>The packages are typically placed in a <em>pool</em> folder, and this folder typically uses a sub-folder structure consisting of first letter or lib plus first letter and name of the source package. This structure is not relevant for the apt repository client tooling, because it’s part of the paths provided in the component package indices.<p>Some tools generate <em><a href=https://wiki.debian.org/DebianRepository/Format#Flat_Repository_Format>flat repositories</a></em> instead of default repositories. These repositories work in the same way, but use a <em>path</em> instead of a distribution name. The distribution <em>InRelease</em> file for these repositories is located at <em>root</em> / <em>path</em> / <em>InRelease</em>. These repositories typically also doesn’t follow the pool structure for organizing the packages.<h3 id=libapt><a aria-label="Anchor link for: libapt" class="header-anchor no-hover-padding" href=#libapt><span aria-hidden=true class=link-icon></span></a> libapt</h3><p>The goal of <em>libapt</em> is to provide a pure Rust library for interfacing with Debian apt repositories. It shall be possible to use <em>libapt</em> to parse an apt repository, get the packages, package metadata, checksums and locations, and verify the validity of the metadata with respect to signatures, compliance with the Debian repository format specification, and existence of packages indices and packages.<p><a href=https://github.com/lts-linux/libapt>Read more</a></section></article></main><div id=button-container><div id=toc-floating-container><input class=toggle id=toc-toggle type=checkbox><label class=overlay for=toc-toggle></label><label title="Toggle Table of Contents" class=button for=toc-toggle id=toc-button><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg></label><div class=toc-content><div class=toc-container><ul><li><a href=https://lts-linux.eu/projects/libapt/#architecture>Architecture</a> <ul><li><a href=https://lts-linux.eu/projects/libapt/#debian-apt-repositories>Debian apt repositories</a><li><a href=https://lts-linux.eu/projects/libapt/#libapt>libapt</a></ul></ul></div></div></div><a title="Go to the top of the page" class=no-hover-padding href=# id=top-button> <svg viewbox="0 0 20 20" fill=currentColor><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg> </a></div><span class=hidden id=copy-success> Copied! </span><span class=hidden id=copy-init> Copy code to clipboard </span><script defer src=https://lts-linux.eu/js/copyCodeToClipboard.min.js></script></div><footer><section><nav class="socials nav-navs"><ul><li><a class="nav-links no-hover-padding social" href=https://lts-linux.eu/atom.xml> <img alt=feed loading=lazy src=https://lts-linux.eu/social_icons/rss.svg title=feed> </a><li class=js><a class="nav-links no-hover-padding social" data-encoded-email="Y29udGFjdEBsdHMtbGludXguZXU=" href=#><img alt=email loading=lazy src=https://lts-linux.eu/social_icons/email.svg title=email> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://github.com/lts-linux> <img alt=github loading=lazy src=https://lts-linux.eu/social_icons/github.svg title=github> </a><li><a class="nav-links no-hover-padding social" rel=" me" href=https://social.tchncs.de/@ltslinux> <img alt=mastodon loading=lazy src=https://lts-linux.eu/social_icons/mastodon.svg title=mastodon> </a></ul></nav><nav class=nav-navs><small> <ul><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/about/> about </a><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/privacy/> privacy policy </a><li><a class="nav-links no-hover-padding" href=https://lts-linux.eu/sitemap.xml> sitemap </a></ul> </small></nav><div class=credits><small> <p><p>LTS Linux © 2024 • Unless otherwise noted, the content in this website is available under the <a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a> license.</p> Powered by <a href=https://www.getzola.org>Zola</a> & <a href=https://github.com/welpo/tabi>tabi</a> • <a href=https://github.com/lts-linux/lts-linux.github.io> Site source </a></small></div></section><script async src=https://lts-linux.eu/js/decodeMail.min.js></script><div class="search-modal js" aria-labelledby=modalTitle id=searchModal role=dialog><h1 class=visually-hidden id=modalTitle>Search</h1><div id=modal-content><div id=searchBar><div aria-hidden=true class=search-icon><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg></div><input aria-controls=results-container aria-expanded=false autocomplete=off id=searchInput placeholder=Search… role=combobox spellcheck=false><div class="close-icon interactive-icon" title="Clear search" id=clear-search role=button tabindex=0><svg viewbox="0 -960 960 960" xmlns=http://www.w3.org/2000/svg><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></div></div><div id=results-container><div id=results-info><span id=zero_results> No results</span><span id=one_results> $NUMBER result</span><span id=many_results> $NUMBER results</span><span id=two_results> $NUMBER results</span><span id=few_results> $NUMBER results</span></div><div id=results role=listbox></div></div></div></div></footer>